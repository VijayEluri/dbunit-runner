<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Apache Maven Doxia at Oct 16, 2015 -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Getting Started</title>
    <style type="text/css" media="all">
      @import url("./css/maven-base.css");
      @import url("./css/maven-theme.css");
      @import url("./css/site.css");
    </style>
    <link rel="stylesheet" href="./css/print.css" type="text/css" media="print" />
    <meta name="Date-Revision-yyyymmdd" content="20151016" />
    <meta http-equiv="Content-Language" content="en" />
        
        </head>
  <body class="composite">
    <div id="banner">
                    <div id="bannerLeft">
                DbUnit Runner
                </div>
                    <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="breadcrumbs">
            
        
                <div class="xleft">
        <span id="publishDate">Last Published: 2015-10-16</span>
                  &nbsp;| <span id="projectVersion">Version: 1.0-beta-6</span>
                      </div>
            <div class="xright">                    <a href="http://www.junit.org/index.htm" class="externalLink" title="JUnit">JUnit</a>
            |
                        <a href="http://www.dbunit.org" class="externalLink" title="DBUnit">DBUnit</a>
              
        
      </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
    <div id="leftColumn">
      <div id="navcolumn">
             
        
                                <h5>Overview</h5>
                  <ul>
                  <li class="none">
            <strong>Getting Started</strong>
          </li>
          </ul>
                                 <h5>Project Documentation</h5>
                  <ul>
                                                                                                                                                                                                                                      <li class="collapsed">
                          <a href="project-info.html" title="Project Information">Project Information</a>
                  </li>
                                                                                                                                                                                                                                                                                            <li class="collapsed">
                          <a href="project-reports.html" title="Project Reports">Project Reports</a>
                  </li>
          </ul>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                   
        
            </div>
    </div>
    <div id="bodyColumn">
      <div id="contentBox">
        <!-- http://maven.apache.org/doxia/references/apt-format.html --><div class="section"><h2>Getting Started<a name="Getting_Started"></a></h2><div class="section"><h3>Setting pom.xml<a name="Setting_pom.xml"></a></h3><div><pre>&lt;project&gt;
  [...]
  &lt;repositories&gt;
    &lt;repository&gt;
      &lt;id&gt;repo.kiy0taka.org&lt;/id&gt;
      &lt;name&gt;kiy0taka.org Maven2 Repository&lt;/name&gt;
      &lt;url&gt;http://repo.kiy0taka.org/&lt;/url&gt;
    &lt;/repository&gt;
  &lt;/repositories&gt;
  [...]
  &lt;dependencies&gt;
    [...]
    &lt;dependency&gt;
      &lt;groupId&gt;org.kiy0taka&lt;/groupId&gt;
      &lt;artifactId&gt;dbunit-runner&lt;/artifactId&gt;
      &lt;version&gt;1.0-beta-4&lt;/version&gt;
      &lt;scope&gt;test&lt;/scope&gt;
    &lt;/dependency&gt;
    &lt;!--
    &lt;dependency&gt;
      &lt;groupId&gt;org.slf4j&lt;/groupId&gt;
      &lt;artifactId&gt;slf4j-nop&lt;/artifactId&gt;
      &lt;version&gt;1.5.6&lt;/version&gt;
    &lt;/dependency&gt;
    --&gt;
    [...]
  &lt;/dependencies&gt;
  [...]
&lt;/project&gt;</pre></div></div><div class="section"><h3>DbUnit Runner Configuration<a name="DbUnit_Runner_Configuration"></a></h3><ol style="list-style-type: decimal"><li>Add dbunit-runner.properties file to src/test/resources directory.</li><li>Edit database properties.<div><pre>###############################################################################
# Configure database connection
###############################################################################
driver=org.h2.Driver
url=jdbc:h2:target/db;SCHEMA=dev
username=scott
password=tiger
#schema=dev

###############################################################################
# Configure features and properties (http://www.dbunit.org/properties.html)
###############################################################################
http\://www.dbunit.org/properties/datatypeFactory=org.dbunit.ext.h2.H2DataTypeFactory </pre></div></li></ol></div><div class="section"><h3>Test Example<a name="Test_Example"></a></h3><div><pre>package example;

import static org.junit.Assert.assertEquals;

import java.math.BigDecimal;
import java.sql.Connection;
import java.sql.Date;
import java.sql.SQLException;
import java.util.Arrays;
import java.util.List;

import org.junit.Before;
import org.junit.runner.RunWith;
import org.kiy0taka.dbunit.DbUnitRunner;
import org.kiy0taka.dbunit.DbUnitTest;
import org.kiy0taka.dbunit.TestConnection;

@RunWith(DbUnitRunner.class)
public class EmpDaoTest {

    @TestConnection
    private Connection connection;

    private EmpDao dao;

    @Before
    public void setUp() {
        dao = new EmpDao();
        dao.setConnection(connection);
    }

    @DbUnitTest(init=&quot;emp.xml&quot;)
    public void findAll() throws SQLException {

        Emp foo = new Emp();
        foo.setEmpno(1);
        foo.setEname(&quot;foo&quot;);
        foo.setHiredate(Date.valueOf(&quot;2009-04-01&quot;));
        foo.setSal(new BigDecimal(&quot;100.00&quot;));

        Emp bar = new Emp();
        bar.setEmpno(2);
        bar.setEname(&quot;bar&quot;);
        bar.setHiredate(Date.valueOf(&quot;2009-07-01&quot;));
        bar.setSal(new BigDecimal(&quot;130.00&quot;));

        List&lt;Emp&gt; expected = Arrays.asList(foo, bar);
        List&lt;Emp&gt; actual = dao.findAll();

        assertEquals(expected, actual);
    }

    @DbUnitTest(init=&quot;emp.xml&quot;)
    public void findByPrimeryKey() throws SQLException {

        Emp expected = new Emp();
        expected.setEmpno(1);
        expected.setEname(&quot;foo&quot;);
        expected.setHiredate(Date.valueOf(&quot;2009-04-01&quot;));
        expected.setSal(new BigDecimal(&quot;100.00&quot;));

        Emp actual = dao.findByEmpno(1);

        assertEquals(expected, actual);
    }

    @DbUnitTest(init=&quot;emp.xml&quot;, expected=&quot;insert.xml&quot;)
    public void insert() throws SQLException {

        Emp newEmp = new Emp();
        newEmp.setEmpno(3);
        newEmp.setEname(&quot;baz&quot;);
        newEmp.setHiredate(Date.valueOf(&quot;2009-10-01&quot;));
        newEmp.setSal(new BigDecimal(&quot;80.00&quot;));

        int count = dao.insert(newEmp);

        assertEquals(1, count);
    }

    @DbUnitTest(init=&quot;emp.xml&quot;, expected=&quot;update.xml&quot;)
    public void update() throws SQLException {

        Emp bar = new Emp();
        bar.setEmpno(2);
        bar.setEname(&quot;bar&quot;);
        bar.setHiredate(Date.valueOf(&quot;2009-07-01&quot;));
        bar.setSal(new BigDecimal(&quot;150.00&quot;));

        int count = dao.update(bar);

        assertEquals(1, count);
    }

    @DbUnitTest(init=&quot;emp.xml&quot;, expected=&quot;delete.xml&quot;)
    public void delete() throws SQLException {

        int count = dao.delete(2);

        assertEquals(1, count);
    }
}</pre></div><p>Example project hosted on <a class="externalLink" href="http://github.com/kiy0taka/dbunit-runner-example">GitHub</a>.</p></div></div>
      </div>
    </div>
    <div class="clear">
      <hr/>
    </div>
    <div id="footer">
      <div class="xright">
              Copyright &#169;                    2015
                        <a href="http://www.kiy0taka.org/">kiy0taka.org</a>.
            All Rights Reserved.      
        
                  </div>
      <div class="clear">
        <hr/>
      </div>
    </div>
  </body>
</html>
